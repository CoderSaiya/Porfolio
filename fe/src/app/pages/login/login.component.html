<div class="login-container">
    <div class="login-card card">
        <div class="login-header">
            <lucide-icon name="Shield" [size]="32"></lucide-icon>
            <h1>Đăng nhập <span class="accent">Admin</span></h1>
            <p>Vui lòng đăng nhập để tiếp tục</p>
        </div>

        <!-- Error banner -->
        <div class="error-banner" *ngIf="errorMessage">
            <lucide-icon name="AlertCircle"></lucide-icon>
            {{ errorMessage }}
        </div>

        <div class="alert-success" *ngIf="registered">
            <lucide-icon name="CheckCircle"></lucide-icon>
            Đăng ký thành công! Vui lòng đăng nhập.
        </div>

        <!-- Username/Password Form -->
        <form *ngIf="!requiresTwoFactor" [formGroup]="loginForm" (ngSubmit)="onLogin()" class="login-form">
            <div class="form-group">
                <label for="username">Tên đăng nhập</label>
                <input id="username" type="text" formControlName="username" class="form-input"
                    placeholder="Nhập tên đăng nhập"
                    [attr.aria-invalid]="loginForm.get('username')?.invalid && loginForm.get('username')?.touched" />
            </div>

            <div class="form-group">
                <label for="password">Mật khẩu</label>
                <input id="password" type="password" formControlName="password" class="form-input"
                    placeholder="Nhập mật khẩu"
                    [attr.aria-invalid]="loginForm.get('password')?.invalid && loginForm.get('password')?.touched" />
            </div>

            <button type="submit" class="btn btn--primary btn--full" [disabled]="loginForm.invalid || loading">
                <span *ngIf="!loading">Đăng nhập</span>
                <span *ngIf="loading" class="spinner"></span>
            </button>

            <div class="divider">
                <span>Hoặc tiếp tục với</span>
            </div>

            <div class="social-login">
                <button type="button" (click)="loginWith('google')" class="btn btn--outline btn--google">
                    <lucide-icon name="Chrome"></lucide-icon>
                    Google
                </button>
                <button type="button" (click)="loginWith('github')" class="btn btn--outline btn--github">
                    <lucide-icon name="Github"></lucide-icon>
                    GitHub
                </button>
            </div>

            <div class="auth-links">
                <p>Chưa có tài khoản? <a routerLink="/register">Đăng ký ngay</a></p>
            </div>
        </form>

        <!-- 2FA Form -->
        <form *ngIf="requiresTwoFactor" [formGroup]="twoFAForm" (ngSubmit)="onVerify2FA()" class="login-form">
            <div class="twofa-header">
                <lucide-icon name="Shield" [size]="48"></lucide-icon>
                <h3>Xác thực 2 yếu tố</h3>
                <p>Nhập mã 6 số từ ứng dụng xác thực</p>
            </div>

            <div class="form-group">
                <label for="code">Mã xác thực</label>
                <input id="code" type="text" formControlName="code" class="form-input code-input" placeholder="000000"
                    maxlength="6"
                    [attr.aria-invalid]="twoFAForm.get('code')?.invalid && twoFAForm.get('code')?.touched" />
            </div>

            <div class="form-actions">
                <button type="button" (click)="cancelTwoFactor()" class="btn btn--outline">
                    Quay lại
                </button>
                <button type="submit" class="btn btn--primary" [disabled]="twoFAForm.invalid || loading">
                    <span *ngIf="!loading">Xác nhận</span>
                    <span *ngIf="loading" class="spinner"></span>
                </button>
            </div>
        </form>
    </div>
</div>