<section class="blog-page">
    <!-- Back to Home Button -->
    <a routerLink="/" class="back-home-btn">
        <lucide-icon name="Home" [size]="20"></lucide-icon>
        <span>Trang chủ</span>
    </a>

    <div class="container">
        <!-- Hero Header -->
        <div class="hero-header">
            <p class="hero-label">BLOG CỦA TÔI</p>
            <h1 class="hero-title">Câu Chuyện & Ý Tưởng</h1>
            <p class="hero-subtitle">Chia sẻ kiến thức và kinh nghiệm lập trình.</p>
        </div>

        <!-- Search Bar -->
        <div class="search-section">
            <lucide-icon name="Search" [size]="20" class="search-icon"></lucide-icon>
            <input type="text" placeholder="Tìm kiếm bài viết..." [(ngModel)]="searchQuery" (input)="onSearch()"
                class="search-input">
        </div>

        <!-- Filter Tabs (Categories) -->
        <div class="filter-tabs">
            <button class="filter-tab" [class.active]="!selectedCategoryId" (click)="filterByCategory(undefined)">
                Tất cả
            </button>
            <button *ngFor="let cat of categories" class="filter-tab" [class.active]="selectedCategoryId === cat.id"
                (click)="filterByCategory(cat.id)">
                {{ cat.name }}
            </button>
        </div>

        <!-- Recent Posts Section -->
        <section class="recent-posts-section" *ngIf="recentPosts.length > 0">
            <h2 class="section-heading">Những bài gần đây</h2>
            <div class="recent-posts-grid">
                <!-- Featured Post (Large) -->
                <article class="featured-post" *ngIf="recentPosts[0]">
                    <a [routerLink]="['/blog', recentPosts[0].slug]" class="post-link">
                        <div class="post-image">
                            <img [src]="recentPosts[0].featuredImage || defaultImage" [alt]="recentPosts[0].title"
                                loading="lazy">
                        </div>
                        <div class="post-content">
                            <div class="post-meta">
                                <span class="post-date">{{ formatDate(recentPosts[0].publishedAt ||
                                    recentPosts[0].createdAt) }}</span>
                                <span class="post-category" *ngIf="recentPosts[0].categoryId">{{
                                    getCategoryName(recentPosts[0].categoryId) }}</span>
                            </div>
                            <h3 class="post-title">{{ recentPosts[0].title }}</h3>
                            <p class="post-summary">{{ recentPosts[0].summary }}</p>
                        </div>
                    </a>
                </article>

                <!-- Sidebar Posts (Small) -->
                <aside class="sidebar-posts">
                    <article class="sidebar-post" *ngFor="let post of recentPosts.slice(1, 4)">
                        <a [routerLink]="['/blog', post.slug]" class="post-link">
                            <div class="post-image-small">
                                <img [src]="post.featuredImage || defaultImage" [alt]="post.title" loading="lazy">
                            </div>
                            <div class="post-content-small">
                                <div class="post-meta">
                                    <span class="post-date">{{ formatDate(post.publishedAt || post.createdAt) }}</span>
                                    <span class="post-category" *ngIf="post.categoryId">{{
                                        getCategoryName(post.categoryId) }}</span>
                                </div>
                                <h4 class="post-title-small">{{ post.title }}</h4>
                            </div>
                        </a>
                    </article>
                </aside>
            </div>
        </section>

        <!-- All Blog Posts Section -->
        <section class="all-posts-section" *ngIf="allPosts.length > 0">
            <h2 class="section-heading">Tất cả bài viết</h2>
            <div class="masonry-grid">
                <article class="masonry-post" *ngFor="let post of allPosts">
                    <a [routerLink]="['/blog', post.slug]" class="post-link">
                        <div class="post-image">
                            <img [src]="post.featuredImage || defaultImage" [alt]="post.title" loading="lazy">
                            <div class="post-overlay"></div>
                            <h3 class="post-title-overlay">{{ post.title }}</h3>
                        </div>
                        <div class="post-info">
                            <div class="post-meta-bottom">
                                <span class="post-category" *ngIf="post.categoryId">{{ getCategoryName(post.categoryId)
                                    }}</span>
                                <span class="post-date">{{ formatDate(post.publishedAt || post.createdAt) }}</span>
                            </div>
                            <span class="post-read-link">Đọc</span>
                        </div>
                    </a>
                </article>
            </div>
        </section>

        <!-- Empty State -->
        <div class="empty-state" *ngIf="!loading && filteredBlogs.length === 0">
            <lucide-icon name="FileText" [size]="64"></lucide-icon>
            <p>Không tìm thấy bài viết nào</p>
        </div>

        <!-- Loading State -->
        <div class="loading-state" *ngIf="loading">
            <div class="spinner"></div>
            <p>Đang tải...</p>
        </div>
    </div>
</section>