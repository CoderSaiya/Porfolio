<section id="projects" class="projects" #sectionRef>
  <div class="container">
    <div class="projects__wrap" [class.slide-in-diagonal]="isVisible">
      <div class="projects__header">
        <span class="badge badge--secondary">Dự án</span>
        <h2 class="projects__title">Dự Án <span class="accent">Nổi Bật</span></h2>
        <div class="projects__underline underline-gradient"></div>
        <p class="projects__subtitle">Những dự án tôi đã tham gia phát triển, từ startup đến enterprise scale</p>
      </div>

      <!-- Bento Grid -->
      <div class="projects__grid" *ngIf="!loading && projects.length > 0">
        <article class="project-card stagger-animation" *ngFor="let p of projects; index as i; trackBy: trackById"
          [style.--stagger]="i" [class.project-card--large]="i === 0" (click)="navigateToProject(p.slug)">
          <div class="project-card__image">
            <img [src]="p.thumb" [attr.loading]="i < 2 ? 'eager' : 'lazy'" [attr.decoding]="'async'"
              (error)="onImgError($event, p.title)" [alt]="p.title" />
            <div class="project-card__overlay"></div>
          </div>

          <div class="project-card__content">
            <div class="badge badge--featured" *ngIf="p.highlight">Nổi bật</div>
            <h3 class="project-card__title">{{ p.title }}</h3>
            <p class="project-card__desc" *ngIf="i === 0">{{ p.description }}</p>
            <div class="project-card__tags" *ngIf="i === 0">
              <span *ngFor="let tech of p.technologies.slice(0, 3)" class="tech-tag">{{ tech }}</span>
            </div>
          </div>
        </article>
      </div>

      <!-- Loading State -->
      <div *ngIf="loading" class="projects__loading">
        <div class="spinner"></div>
        <p>Đang tải dự án...</p>
      </div>

      <!-- Error State -->
      <div *ngIf="error && !loading" class="projects__error">
        <p>{{ error }}</p>
      </div>

      <!-- View All Button -->
      <div class="projects__more" *ngIf="!loading && projects.length > 0">
        <button class="btn btn--outline" (click)="navigateToProjects()">
          Xem Tất Cả Dự Án
          <lucide-icon name="ArrowRight"></lucide-icon>
        </button>
      </div>
    </div>
  </div>
</section>