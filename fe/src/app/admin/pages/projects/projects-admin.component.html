<div class="projects-admin">
    <div class="page-header">
        <div>
            <h1>Quản lý <span class="accent">Dự án</span></h1>
            <p class="subtitle">Tạo, chỉnh sửa và quản lý các dự án của bạn</p>
        </div>
        <a routerLink="/admin/projects/new" class="btn btn--primary">
            <lucide-icon name="Plus"></lucide-icon>
            Tạo dự án mới
        </a>
    </div>

    <div class="error-banner" *ngIf="error">
        <lucide-icon name="AlertCircle"></lucide-icon>
        {{ error }}
    </div>

    <div class="projects-table card" *ngIf="!loading">
        <table *ngIf="projects.length > 0">
            <thead>
                <tr>
                    <th>Tiêu đề</th>
                    <th>Slug</th>
                    <th>Nổi bật</th>
                    <th>Thời gian</th>
                    <th>Nhóm</th>
                    <th>Công nghệ</th>
                    <th class="actions-col">Thao tác</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let project of projects">
                    <td class="title-col">
                        <div class="project-title">
                            <img *ngIf="project.imageUrl" [src]="project.imageUrl" alt="{{project.title}}"
                                class="project-thumb" />
                            <span>{{ project.title }}</span>
                        </div>
                    </td>
                    <td><code class="slug">{{ project.slug }}</code></td>
                    <td>
                        <span class="badge" [class.badge--highlight]="project.highlight">
                            {{ project.highlight ? 'Có' : 'Không' }}
                        </span>
                    </td>
                    <td>{{ project.duration }} tháng</td>
                    <td>{{ project.teamSize }} {{ project.teamSize === 1 ? 'người' : 'người' }}</td>
                    <td>
                        <div class="tech-tags">
                            <span class="tech-tag" *ngFor="let tech of project.technologies.slice(0, 3)">{{ tech
                                }}</span>
                            <span class="tech-tag more" *ngIf="project.technologies.length > 3">
                                +{{ project.technologies.length - 3 }}
                            </span>
                        </div>
                    </td>
                    <td class="actions-col">
                        <div class="actions">
                            <a [routerLink]="['/admin/projects/edit', project.id]" class="btn btn--icon btn--ghost"
                                title="Chỉnh sửa">
                                <lucide-icon name="Edit"></lucide-icon>
                            </a>
                            <button (click)="confirmDelete(project)" class="btn btn--icon btn--ghost btn--danger"
                                title="Xóa">
                                <lucide-icon name="Trash2"></lucide-icon>
                            </button>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>

        <div class="empty-state" *ngIf="projects.length === 0">
            <lucide-icon name="FolderOpen" [size]="48"></lucide-icon>
            <h3>Chưa có dự án nào</h3>
            <p>Bắt đầu bằng cách tạo dự án đầu tiên của bạn</p>
            <a routerLink="/admin/projects/new" class="btn btn--primary">
                <lucide-icon name="Plus"></lucide-icon>
                Tạo dự án
            </a>
        </div>
    </div>

    <div class="loading-state" *ngIf="loading">
        <div class="spinner"></div>
        <p>Đang tải dự án...</p>
    </div>
</div>

<!-- Delete Confirmation Modal -->
<div class="modal-overlay" *ngIf="projectToDelete" (click)="cancelDelete()">
    <div class="modal card" (click)="$event.stopPropagation()">
        <div class="modal-header">
            <lucide-icon name="AlertTriangle" class="warning-icon"></lucide-icon>
            <h2>Xóa dự án</h2>
        </div>
        <div class="modal-body">
            <p>Bạn có chắc chắn muốn xóa <strong>{{ projectToDelete.title }}</strong>?</p>
            <p class="warning-text">Hành động này không thể hoàn tác.</p>
        </div>
        <div class="modal-actions">
            <button (click)="cancelDelete()" class="btn btn--outline">Hủy</button>
            <button (click)="deleteProject()" class="btn btn--danger">Xóa</button>
        </div>
    </div>
</div>